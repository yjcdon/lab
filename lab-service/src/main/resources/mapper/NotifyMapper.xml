<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lab.mapper.NotifyMapper">

    <insert id="insertForTypeAdd">
        INSERT INTO notify (content, user_id, notify_type)
        VALUES (#{dto.content}, #{dto.userId}, #{dto.notifyType})

    </insert>
    <select id="getById" resultType="com.lab.vo.NotifySingleVo">
        SELECT
        content,
        create_time,
        is_look,
        <choose>
            <when test="notify_type == 1">
                '新增任务' AS notify_type_name
            </when>
            <when test="notify_type == 2">
                '删除任务' AS notify_type_name
            </when>
            <when test="notify_type == 3">
                '修改任务' AS notify_type_name
            </when>
            <otherwise>
                '未知类型' AS notify_type_name
            </otherwise>
        </choose>
        FROM notify
        WHERE id = #{id} and is_delete = 0
    </select>
    <select id="list" resultType="com.lab.vo.NotifyListVo">
        SELECT content, create_time, is_look
        FROM notify
        WHERE user_id = #{dto.userId}
          and is_delete = 0;
    </select>
    <delete id="delete">
        update notify
        set is_delete = 1
        where id in
        <foreach collection="ids" item="id" separator="," open="(" close=")">
            #{id}
        </foreach>
    </delete>

</mapper>
